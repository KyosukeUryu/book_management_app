<div class="books_wrapper">
  <h2>他ユーザーが読んだ書籍</h2>
  <%= search_form_for @q, url: disposal_finished_books_path do |f| %>
    <%= f.label :title_or_author_cont, 'タイトルか著者名' %>
    <%= f.search_field :title_or_author_cont %>

    <%= f.submit %>
  <% end %>
  <%= link_to '元に戻す', disposal_finished_books_path %>

  <table>
    <tr>
      <th>書籍名</th>
      <th>著者名</th>
      <th>ユーザー名</th>
      <th>処分予定時期</th>
      <th>メッセージを送る</th>
      <th>お気に入り</th>
    </tr>
    <% @finished_books.each do |book| %>
      <tr>
        <td><%= link_to book.title, finished_book_path(book) %></td>
        <td><%= book.author %></td>
        <td><%= link_to book.user.name, user_path(book.user) %></td>
        <td><%= book.desposal_expired %></td>
        <td><%= link_to 'メッセージを送る', conversations_path(sender_id: current_user.id, recipient_id: book.user.id), method: :post %></td>
        <% if current_user.concerned?(book) %>
          <td><%= link_to '気になる書籍から外す', concern_book_path(current_user.concern_books.find_by(finished_book_id: book.id)), method: :delete %></td>
        <% else %>
          <td><%= link_to '気になる書籍に追加する', concern_books_path(finished_book_id: book.id), method: :post %></td>
        <% end %>
      </tr>
    <% end %>
  </table>
  <%= paginate @finished_books %>
  <%= link_to '新規未読書籍登録', new_unread_book_path %>
</div>
